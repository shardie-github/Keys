# Asset Schemas

**Purpose**: JSON schemas for validating asset metadata files

---

## Schemas

### `pack.schema.json`

Schema for runbook pack metadata (`pack.json` files).

**Location**: `/keys-assets/runbook-keys/<slug>/pack.json`

**Validates**:
- Required fields (slug, title, description, tool, key_type, version, etc.)
- Slug format (lowercase alphanumeric + hyphens)
- Enum values (tool, key_type, maturity, etc.)
- References to Jupyter Keys and Node Keys
- Documentation file paths

---

### `key.schema.json`

Schema for Node/Next key metadata (`key.json` files).

**Location**: `/keys-assets/node-next-keys/<slug>/key.json`

**Validates**:
- Required fields (slug, title, description, tool, key_type, runtime, version, etc.)
- Slug format (lowercase alphanumeric + hyphens)
- Enum values (tool, key_type, runtime, maturity, etc.)
- Environment variable requirements
- Dependency specifications
- Compatibility requirements

---

### `library.schema.json`

Schema for Jupyter Keys library index (`library.json` files).

**Location**: Generated by notebook repository, consumed by KEYS marketplace

**Validates**:
- Root structure (version, generated_at, packs)
- Pack array (min 1 pack)
- Pack metadata (slug, title, version, license_spdx, assets)
- Asset specifications (zip required, cover/preview_html/changelog_md optional)
- SHA256 hash format

---

## Usage

### Validation Tool

Use the validation tool in `/keys-assets/tools/validate_assets.ts`:

```bash
# Validate all assets
npm run validate:assets

# Validate specific asset type
npm run validate:assets -- --type=runbooks
npm run validate:assets -- --type=node-keys
npm run validate:assets -- --type=library
```

### Manual Validation

Using `ajv` CLI or Node.js:

```bash
# Install ajv-cli
npm install -g ajv-cli

# Validate a pack.json
ajv validate -s schemas/pack.schema.json -d runbook-keys/<slug>/pack.json

# Validate a key.json
ajv validate -s schemas/key.schema.json -d node-next-keys/<slug>/key.json

# Validate a library.json
ajv validate -s schemas/library.schema.json -d library.json
```

---

## Schema Versioning

- Schemas follow semantic versioning
- Breaking changes increment major version
- New optional fields increment minor version
- Bug fixes increment patch version

---

## References

- [JSON Schema Specification](https://json-schema.org/)
- [SPDX License List](https://spdx.org/licenses/)
